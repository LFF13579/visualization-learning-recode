<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id="main" width="1200px" height="1200px"></canvas>


    <script>
        let canvas = document.querySelector('#main')
        let ctx = canvas.getContext('2d')

        // 小球构造函数
        function Ball(x,y,r) {
            this.x = x
            this.y = y
            this.r = r
            this.color = getRandomColor()
            // x行进距离
            this.dx = parseInt(Math.random()*8)-4
            // y行进距离
            this.dy = parseInt(Math.random()*8)-4
            // 维护小球到数组中
            ballArr.push(this)
        }
        // canvas鼠标监听,鼠标移动过程中创建小球
        canvas.addEventListener('mousemove',function (e) {
            new Ball(e.offsetX,e.offsetY,16);
        })
        // 获取随机颜色
        function getRandomColor() {
            let allColor = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f',]
            let color = '#'
            for (let i = 0; i < 6; i++) {
                let random = parseInt(Math.random() * allColor.length)     
                color = color +allColor[random]      
            }
            return color
        }
        // 更新
        Ball.prototype.update = function () {
            this.x += this.dx
            this.y += this.dy
            this.r -= 0.2

            if (this.r<=0) {
                this.remove()
            }

        }
        // 移除当前小球
        Ball.prototype.remove = function () {
            for (let i = 0; i < ballArr.length; i++) {
                if (ballArr[i] == this) {
                    ballArr.splice(i,1)
                }
            }
        }
        // 渲染
        Ball.prototype.render = function() {
            ctx.beginPath()
            ctx.arc(this.x,this.y,this.r,0,Math.PI * 2,false)
            ctx.fillStyle = this.color
            ctx.fill()
        }
        let ballArr = []
        // 动画过程
        setInterval(() => {
            ctx.clearRect(0,0,canvas.width,canvas.height)
            for (let i = 0; i < ballArr.length; i++) {
                ballArr[i].update()
                if (ballArr[i]) {
                    ballArr[i].render()
                } 
            }

        }, 10);
    </script>
</body>
</html>